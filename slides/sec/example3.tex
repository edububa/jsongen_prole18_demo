\section{Testing a web service state correctness with a jsongen model}

\begin{frame}{Testing a web service state correctness with a jsongen model}
  \begin{itemize}
  \item The main objective of this example is to give a general idea
    of how to use jsongen to test the state of a web service.
  \item The web service state:\\
  \end{itemize}
  \vspace{20pt}
  \centering
  \begin{tabular}{| c | c |}
    \hline
    \textbf{Operation}   & \textbf{Changes the state} \\ \hline
    new user    & yes \\ \hline
    new account & yes \\ \hline
    balance     & no \\ \hline
    withdraw    & yes \\ \hline
    deposit     & yes \\ \hline
  \end{tabular}
  \centering
\end{frame}

\begin{frame}{State analysis}
  \vspace{10pt}
  \begin{tabular}{p{7cm} l}
    {\Large Abstract state machine}&{\Large Server state}
  \end{tabular}
  \\
  \begin{figure}
    \centering
    \begin{overprint}[\textwidth]
      \onslide<1> \includestandalone[mode=buildnew, width=\textwidth]{./figures/figure-state-1}
      \onslide<2> \includestandalone[mode=buildnew, width=\textwidth]{./figures/figure-state-2}
      \onslide<3> \includestandalone[mode=buildnew, width=\textwidth]{./figures/figure-state-3}
      \onslide<4->\includestandalone[mode=buildnew, width=\textwidth]{./figures/figure-state-4}
    \end{overprint}
  \end{figure}
\end{frame}


\begin{frame}{Abstract state machine interface}
  To program the abstract state machine we need to implement the
  following functions:

  \inputminted{erlang}{./code/interface.erl}
\end{frame}

\begin{frame}{Abstract state machine bank intial state}
  We will model our state as:

  \inputminted{erlang}{./code/state.erl}
\end{frame}

% \begin{frame}{Model: next\_state}
%   This function changes our model' state.

%   \inputminted{erlang}{./code/next_state.erl}
% \end{frame}

\begin{frame}{Abstract state machine bank next\_state}
  \inputminted{erlang}{./code/next_model_state.erl}
\end{frame}

\begin{frame}
  \inputminted{erlang}{./code/next_model_state1.erl}
\end{frame}

% \begin{frame}{Model: postcondition}
%   This function checks the postcondition properties defined in the
%   model.

%   \inputminted{erlang}{./code/postcondition.erl}
% \end{frame}

\begin{frame}{Abstract state machine bank postcondition\_state}
  \inputminted{erlang}{./code/postcondition_model_state.erl}
\end{frame}

\begin{frame}{}{}
  \begin{center}
    \vspace{15pt}
    {\Huge Demo}
  \end{center}
\end{frame}